<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Untuk Sayangku 💖</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fff0f5; /* Soft pink background */
      color: #333;
      padding: 20px;
      max-width: 800px;
      margin: auto;
      text-align: center;
      overflow-x: hidden; /* Prevent horizontal scroll from animations */
      position: relative; /* For background animation */
    }
    h1, h2 {
      color: #d6336c; /* Deep rose color */
      margin-bottom: 15px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.05); /* Soft text shadow */
    }
    p {
      line-height: 1.6;
      margin-bottom: 10px;
    }
    strong {
      color: #e0559e; /* Slightly darker pink for emphasis */
    }
    button {
      background-color: #ff69b4; /* Hot pink */
      border: none;
      color: white;
      padding: 15px 30px;
      font-size: 16px;
      border-radius: 10px;
      margin: 10px 5px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden; /* For any internal effects if added */
      box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Initial shadow */
    }
    button:hover {
      background-color: #e0559e;
      transform: translateY(-3px); /* More pronounced lift */
      box-shadow: 0 6px 12px rgba(0,0,0,0.15); /* Stronger shadow on hover */
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    #response, #next-section, #final-section {
      display: none;
      margin-top: 30px;
      opacity: 0; /* Initial state for transition */
      transform: translateY(20px); /* Initial state for transition */
      transition: opacity 1s ease-out, transform 1s ease-out;
    }
    #response.is-visible,
    #next-section.is-visible,
    #final-section.is-visible {
      opacity: 1;
      transform: translateY(0);
    }
    .section {
      background: #fff;
      padding: 25px;
      border-radius: 15px; /* Softer corners */
      box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* Slightly more prominent shadow */
      margin-top: 30px;
      text-align: left;
      overflow: hidden; /* Important for inner elements */
      border: 1px solid #ffe4e1; /* Subtle border */
    }
    .video-wrapper {
      display: flex;
      justify-content: center;
      margin: 25px 0;
    }
    video, iframe {
      max-width: 100%;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    .heart-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 25px;
      font-size: 38px; /* Larger hearts */
    }
    .heart {
      color: red;
      margin: 5px;
      animation: float 1s infinite alternate;
      opacity: 0; /* Initially hidden for staggered fade-in */
      transition: opacity 0.5s ease-in;
      text-shadow: 0 0 8px rgba(255,0,0,0.5); /* Glowing hearts */
    }
    .music-animate {
      margin-top: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .bar {
      width: 8px; /* Wider bars */
      height: 30px; /* Taller bars */
      background: linear-gradient(to top, #ff69b4, #ffb6c1); /* Gradient for bars */
      margin: 0 4px;
      display: inline-block;
      animation: bounce 1s infinite ease-in-out;
      border-radius: 2px; /* Slightly rounded bars */
    }
    .bar:nth-child(2) { animation-delay: 0.2s; }
    .bar:nth-child(3) { animation-delay: 0.4s; }
    .bar:nth-child(4) { animation-delay: 0.6s; }

    /* Animations */
    @keyframes bounce {
      0%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(2); }
    }
    @keyframes float {
      from { transform: translateY(0); }
      to { transform: translateY(-15px); } /* More pronounced float */
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* New styles for countdown */
    #countdown-timer {
      display: inline-block;
      margin-left: 10px;
      font-size: 15px;
      color: #555; /* Darker gray for readability */
      font-weight: bold;
    }

    /* Animated background */
    .animated-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
      background: radial-gradient(circle at top left, #ffc0cb30, transparent 50%),
                  radial-gradient(circle at bottom right, #add8e630, transparent 50%);
      animation: backgroundPan 60s infinite alternate ease-in-out;
    }

    @keyframes backgroundPan {
      0% { background-position: 0% 0%, 100% 100%; }
      100% { background-position: 100% 100%, 0% 0%; }
    }

    /* Floating heart particles */
    .floating-particle {
      position: absolute;
      color: #ff69b4;
      font-size: 20px; /* Slightly larger */
      opacity: 0;
      animation: floatUp 12s infinite ease-out; /* Longer animation duration */
      pointer-events: none;
      text-shadow: 0 0 6px rgba(255,105,180,0.6); /* Stronger soft glow */
      will-change: transform, opacity; /* Performance optimization */
    }

    @keyframes floatUp {
      0% { transform: translateY(0vh) scale(0.5); opacity: 0; }
      20% { opacity: 0.8; }
      100% { transform: translateY(-120vh) scale(1.5); opacity: 0; } /* Floats higher and larger */
    }

    /* Interactive love dots */
    .love-reasons-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin: 20px 0;
    }
    .love-dot {
      font-size: 32px; /* Larger dots */
      margin: 0 10px;
      cursor: pointer;
      transition: transform 0.3s ease, filter 0.3s ease, text-shadow 0.3s ease; /* Added text-shadow transition */
      filter: grayscale(100%); /* Desaturated until clicked */
      text-shadow: none;
    }
    .love-dot:hover {
      transform: scale(1.3); /* More pronounced scale */
      filter: grayscale(0%); /* Full color on hover */
      text-shadow: 0 0 10px rgba(255, 105, 180, 0.8); /* Glow on hover */
    }
    .love-dot.active { /* Class when clicked */
      filter: grayscale(0%);
      transform: scale(1.4); /* Even larger when active */
      text-shadow: 0 0 12px rgba(255, 105, 180, 1); /* Stronger glow when active */
    }
    #love-reason-display {
      margin-top: 15px;
      font-style: italic;
      color: #d6336c;
      min-height: 40px; /* Prevent layout shift */
      font-size: 1.2em;
      font-weight: 600; /* Slightly bolder */
      transition: opacity 0.5s ease-in-out; /* Smooth transition for text change */
    }
    .instruction-text {
      font-size: 1em;
      color: #777;
      margin-top: 10px;
      font-style: italic;
    }

    /* Add a subtle animation to sections as they appear */
    .section.is-visible {
      animation: slideInUp 1s ease-out forwards;
    }

    @keyframes slideInUp {
      from { opacity: 0; transform: translateY(50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Confetti Burst (optional, can be triggered on final reveal) */
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #ff69b4; /* Hot pink */
      border-radius: 50%;
      animation: confettiFall 3s ease-out forwards;
      opacity: 0;
      pointer-events: none;
      z-index: 9999;
    }
    .confetti.red { background-color: #ff0000; }
    .confetti.pink { background-color: #ffc0cb; }
    .confetti.gold { background-color: #ffd700; }

    @keyframes confettiFall {
      0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    /* Smooth scroll behavior */
    html {
      scroll-behavior: smooth;
    }
  </style>
</head>
<body>
  <div class="animated-background"></div>

  <div class="video-wrapper">
    <video id="openingVideo" src="Opening1.mp4" controls></video>
  </div>

  <h1>Haiiii sayangkuuuu... 💖</h1>
  <p>Kamu tau nggak hari ini tanggal berapa?</p>
  <p><strong>1 Agustus — National Girlfriend Day! 🎉</strong></p>
  <p>Walaupun keadaan kita kayak sekarang, aku tetap mau rayain hari ini untuk kamu yang selalu jadi cewek paling spesial di hati aku. 📌</p>
  <p>Gimana kabar kamu hari ini? Sehat?</p>

  <div>
    <button onclick="respond('sehat')">Aku sehat</button>
    <button onclick="respond('sakit')">Aku lagi sakit</button>
  </div>

  <div id="response"></div>

  <div id="next-section">
    <div class="section">
<h2>💌 Surat Cinta Buat Kamu</h2> 
      <p>Haii sayangkuuu, manisku, cintaku...</p> 
      <p>Selamat Hari National Girlfriend Day yaa! 🩷</p> 
      <p>Aku cuma mau bilang satu hal yang dari dulu gak pernah berubah: aku sayang kamu, aku cinta kamu, dan aku selalu bersyukur pernah punya kamu di hidupku. <span id="personal-memory" style="font-style: normal; color: #ff1493;"></span></p> 
      <p>Makasih ya udah jadi seseorang yang begitu berarti buat aku. Kita udah jalan bareng sejauh ini, lewatin banyak cerita yang gak akan pernah bisa aku lupain. Tapi... pada akhirnya, kita harus <strong>putus</strong>.</p> 
      <p><strong>Tapi aku percaya, putus ini bukan akhir dari segalanya. Aku percaya, ada cerita yang masih bisa kita perjuangkan, walaupun jalannya gak mudah.</strong></p> 
      <p>Karena buat aku, cinta ini gak berhenti di kata "putus".</p> 
      <p>Putus bukan berarti perasaanku hilang begitu aja.<br> 
      Bukan berarti aku berhenti peduli sama kamu.<br> 
      Dan bukan berarti kamu gak penting lagi buat aku.</p> 
      <p>Aku tahu kita sama-sama punya kekurangan. Aku sering nyebelin, kamu juga kadang ngeselin 😅 Tapi di balik semua itu... di hati aku, cuma ada kamu. Selalu kamu. Gak pernah berubah.</p> 
      <p>Aku cuma mau kamu bahagia, beneran. Tapi jujur, bagian terdalam dari hatiku masih pengen jadi alasan di balik senyuman kamu.</p> 
      <p>Aku gak pernah nyerah. Aku masih mau berjuang, bukan karena aku yakin kamu bakal balik, tapi karena aku tahu: kamu layak untuk diperjuangkan.</p> 
      <p>Kalaupun akhirnya aku harus terluka, aku lebih milih itu... daripada hidup dengan penyesalan karena gak pernah nyoba lagi.</p> 
      <p><strong>Aku masih di sini, masih percaya, dan masih cinta...</strong></p> 
      <p><em>Dan selama kamu masih jadi orang yang aku cinta, aku gak akan pernah benar-benar pergi.</em></p> 
      <p><strong>Aku janji... aku bakal belajar dari semua salahku, sayang kamu lebih tulus dari sebelumnya, dan jaga kamu lebih baik dari hari kemarin.</strong></p> 
      <p>Kalau suatu hari nanti kamu buka hati lagi, aku harap masih ada tempat kecil di situ... buat aku.</p>


      <p class="instruction-text">Klik hati-hati di bawah ini untuk tahu kenapa aku sayang banget sama kamu! 👇</p>
      <div class="love-reasons-container">
        <span class="love-dot" data-reason="kamu itu selalu sabar ngadepin aku dan semua tingkahku.">💖</span>
        <span class="love-dot" data-reason="senyum kamu selalu bisa bikin hariku cerah.">💖</span>
        <span class="love-dot" data-reason="kepedulian kamu itu tulus banget.">💖</span>
        <span class="love-dot" data-reason="kamu itu orang yang paling ngertiin aku.">💖</span>
        <span class="love-dot" data-reason="kamu selalu bikin aku jadi versi terbaik dari diriku.">💖</span>
      </div>
      <p id="love-reason-display"></p>
    </div>

    <div class="section">
      <h2>✨ Kabar dan Kerjaan Kamu</h2>
      <p>Gimana kabarmu belakangan ini? Kerjaan kamu lancar nggak sayang?</p>
      <p>Aku bener-bener berharap semua berjalan lancar buat kamu yaa... 💪</p>
    </div>

    <div class="section">
      <h2>😞 Maaf Yaa Sayangg Aku Terlalu Lama Tenggelam Dalam Pikiran</h2>
      <p>Aku minta maaf ya... Selama ini aku terlalu tenggelam sama perasaan dan masalahku sendiri...</p>
      <p>Sampai aku lupa, kamu itu orang yang paling aku sayang 😞</p>
      <blockquote>“Kalau nggak bisa tepatin janji, mending jangan janji, karena itu bisa merusak kepercayaan.”</blockquote>
      <p>Aku kecewa juga sama diri sendiri karena udah bikin kamu ngerasain kayak gitu.</p>
    </div>

    <div class="section">
      <h2>💡 Ide Biar Nggak Kecewain Lagi</h2>
      <p>Mulai sekarang, aku bakal simpen semua janji aku di <strong>Microsoft Planner</strong>:</p>
      <ul>
        <li>Biar aku nggak lupa lagi</li>
        <li>Biar aku bisa buktiin kalau aku serius jaga janji</li>
        <li>Biar kamu juga bisa lihat progress-nya 💞</li>
      </ul>
      <div class="video-wrapper">
        <video id="ourPlantVideo" controls>
          <source src="ourplant.mp4" type="video/mp4" />
        </video>
      </div>
    </div>

    <div class="section">
      <h2>⏳ Maaf Yaa Aku Kurang Luangin Waktu Buat Kamu</h2>
      <p>Setelah magang, aku kurang nyempetin waktu buat kamu...</p>
      <p>Kamu udah bilang, walaupun nggak ketemu, setidaknya tetap komunikasi dan call...</p>
      <p>Aku ngerti sekarang kenapa kamu ngerasa jauh... 😔</p>
    </div>

    <div class="section">
      <h2>🥺 Aku Kangen Kamu</h2>
      <p>Jujur, aku kangen banget sama kamu...</p>
      <ul>
        <li>Kangen dengerin suara kamu</li>
        <li>Kangen balesan chat kamu</li>
        <li>Kangen bisa ketemu langsung</li>
      </ul>
      <p>Semoga aku masih punya kesempatan buat perbaiki semuanya...</p>
      <p style="color:#ff1493;"><strong>Love you so much, honeiiiiii 💖</strong></p>
    </div>

    <button id="nextButton" onclick="showFinal()" disabled>Next <span id="countdown-timer"></span></button>
  </div>

  <div id="final-section">
    <h2>📌 Dari Hati Aku...</h2>
    <p><strong>
      Aku sadar aku banyak salah… dan aku nggak mau nyari alasan. 
      Aku cuma pengin bilang kalau aku masih sayang banget sama kamu. 
      Kalau kamu masih mau, aku pengin punya kesempatan buat buktiin 
      kalau aku bisa jadi lebih baik dari sebelumnya. 
      I love you sooo muchhhh honeiii ❤️
    </strong></p>

    <div class="video-wrapper">
      <video id="finalVideo" controls>
        <source src="Video1.mp4" type="video/mp4" />
      </video>
    </div>

    <div id="hearts" class="heart-container">
    </div>

    <div class="section music-animate">
      <h2>🎶 Playlist Spesial Buat Kamu</h2>
      <p>Aku bikin playlist ini buat kamu, dari hati akuu 💗</p>
      <div class="bar-container" style="display:flex; align-items:flex-end;">
        <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
        <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
      </div>
      <iframe id="spotifyEmbed" style="margin-top: 20px; border-radius: 12px;" src="https://open.spotify.com/embed/playlist/3BVP1x0C324uC3psfBnKNw?utm_source=generator" width="100%" height="152" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
    </div>

    <div class="section">
      <h2>🎥 Video TikTok Buat Kamu</h2>
      <p>Ini video-video lucu dan manis yang aku pilih khusus buat kamu 💞</p>
      <div class="video-wrapper"><iframe class="tiktok-frame" src="https://www.tiktok.com/embed/v2/7505068982903246102" width="325" height="578" frameborder="0" allowfullscreen></iframe></div>
      <div class="video-wrapper"><iframe class="tiktok-frame" src="https://www.tiktok.com/embed/v2/7523075095464561925" width="325" height="578" frameborder="0" allowfullscreen></iframe></div>
      <div class="video-wrapper"><iframe class="tiktok-frame" src="https://www.tiktok.com/embed/v2/7521845733012589846" width="325" height="578" frameborder="0" allowfullscreen></iframe></div>
      <div class="video-wrapper"><iframe class="tiktok-frame" src="https://www.tiktok.com/embed/v2/7525687776088493343" width="325" height="578" frameborder="0" allowfullscreen></iframe></div>
      </div>

    <div class="section">
        <h2>Kenangan Manis Kita</h2>
        <p>Ada beberapa hal acak yang selalu ngingetin aku sama kamu:</p>
        <ul id="memories-list" style="list-style-type: none; padding: 0;">
            </ul>
    </div>
    </div>

  <audio id="audioPlayer" preload="auto" loop></audio>

  <script>
    const audioPlayer = document.getElementById("audioPlayer");
    const nextButton = document.getElementById("nextButton");
    const countdownTimerDisplay = document.getElementById("countdown-timer");
    const responseSection = document.getElementById("response");
    const nextSection = document.getElementById("next-section");
    const finalSection = document.getElementById("final-section");
    const openingVideo = document.getElementById("openingVideo");
    const ourPlantVideo = document.getElementById("ourPlantVideo");
    const finalVideo = document.getElementById("finalVideo");
    const heartsContainer = document.getElementById("hearts");
    const spotifyEmbed = document.getElementById("spotifyEmbed");
    const memoriesList = document.getElementById("memories-list");
    const tiktokFrames = document.querySelectorAll('.tiktok-frame');


    let bgMusicPlayed = false;
    let initialInteractionTime = null;
    const minDelay = 2 * 60 * 1000; // 2 menit
    let countdownInterval;

    // --- Helper Functions ---
    function fadeInElement(element, scroll = false) {
      element.style.display = "block";
      setTimeout(() => {
        element.classList.add('is-visible');
        if (scroll) {
          element.scrollIntoView({ behavior: "smooth", block: "nearest" });
        }
      }, 50);
    }

    function playBackgroundMusic() {
      // Only set source and play if it hasn't been played before or if it was paused
      if (!bgMusicPlayed) {
        audioPlayer.src = "night_changes.mp3"; // Set source only once
        bgMusicPlayed = true; // Mark as played
      }
      if (audioPlayer.paused && audioPlayer.src) { // Only play if paused and source exists
        audioPlayer.play().catch(e => console.log("Autoplay prevented:", e));
      }
    }

    function pauseBackgroundMusic() {
      if (!audioPlayer.paused) {
        audioPlayer.pause();
      }
    }

    // Function to stop all other media, with an exception for ourPlantVideo
    function stopAllOtherMedia(currentMedia = null) {
      // Pause background music if it's not the `ourPlantVideo` and it's playing
      if (currentMedia !== ourPlantVideo) { // EXCEPTION: Don't pause BGM if currentMedia is ourPlantVideo
          pauseBackgroundMusic();
      }

      // Pause local videos, excluding the current playing one
      [openingVideo, ourPlantVideo, finalVideo].forEach(video => {
        if (video && video !== currentMedia) {
          video.pause();
        }
      });

      // For iframes (Spotify/TikTok), we can't directly control their media playback.
      // The assumption here is that user interaction with an iframe implies they want
      // to listen to that iframe's audio, so we stop our own.
    }


    function updateCountdown() {
      if (!initialInteractionTime) return;

      const timeElapsed = Date.now() - initialInteractionTime;
      const timeLeft = minDelay - timeElapsed;

      if (timeLeft <= 0) {
        nextButton.disabled = false;
        countdownTimerDisplay.textContent = "(Siap!)"; // Changed countdown message
        clearInterval(countdownInterval);
        console.log("Countdown finished, Next button enabled.");
      } else {
        const totalSeconds = Math.floor(timeLeft / 1000);
        const minutes = Math.floor(totalSeconds / 60);
        const seconds = totalSeconds % 60;
        countdownTimerDisplay.textContent = `(${minutes}:${seconds < 10 ? '0' : ''}${seconds})`;
      }
    }

    function generateFloatingParticles() {
      const particleEmojis = ['💖', '✨', '❤️', '🩷', '💜']; // Added more emojis
      const numberOfParticles = 30; // Increased number of particles

      for (let i = 0; i < numberOfParticles; i++) {
        const particle = document.createElement('span');
        particle.classList.add('floating-particle');
        particle.textContent = particleEmojis[Math.floor(Math.random() * particleEmojis.length)];
        particle.style.left = `${Math.random() * 100}vw`;
        particle.style.animationDelay = `${Math.random() * 15}s`; // Longer random delay
        particle.style.animationDuration = `${8 + Math.random() * 7}s`; // Varied animation duration
        particle.style.fontSize = `${18 + Math.random() * 12}px`; // More varied sizes
        document.body.appendChild(particle);
      }
    }

    function generateConfetti() {
      const colors = ['red', 'pink', 'gold', 'hotpink'];
      const numConfetti = 50;
      for (let i = 0; i < numConfetti; i++) {
        const confetti = document.createElement('div');
        confetti.classList.add('confetti');
        confetti.classList.add(colors[Math.floor(Math.random() * colors.length)]);
        confetti.style.left = `${Math.random() * 100}vw`;
        confetti.style.top = `${-20 - Math.random() * 50}px`; // Start above the screen
        confetti.style.animationDelay = `${Math.random() * 2}s`;
        document.body.appendChild(confetti);

        // Remove confetti after animation to prevent DOM clutter
        confetti.addEventListener('animationend', () => {
          confetti.remove();
        });
      }
    }

    // --- Event Handlers ---
    function respond(status) {
      responseSection.innerHTML = status === "sehat" ? "Yeyyy kamu sehatttt! 💖" : "Hiksss sayangkuuu sakit... 😢 semoga cepet sembuh yaaa.";
      fadeInElement(responseSection);
      playBackgroundMusic(); // *** Musik latar akan diputar di sini saat tombol ini diklik ***

      if (!initialInteractionTime) {
          initialInteractionTime = Date.now();
          countdownInterval = setInterval(updateCountdown, 1000);
          updateCountdown();
      }

      setTimeout(() => {
        fadeInElement(nextSection, true); // True to enable scrolling to nextSection
        generateFloatingParticles();
      }, 1500);
    }

    function showFinal() {
      fadeInElement(finalSection, true); // Scroll to final section
      pauseBackgroundMusic();
      audioPlayer.src = ""; // Clear the audio source to permanently stop BGM
      finalVideo.addEventListener("play", () => stopAllOtherMedia(finalVideo));
      finalVideo.addEventListener("ended", () => {
        staggerHeartsAppearance();
        generateConfetti(); // Trigger confetti when video ends
        // NO playBackgroundMusic() call here, as it's permanently stopped
      });
      finalVideo.addEventListener("pause", () => {
        // No action needed here as background music is permanently stopped
      });
      clearInterval(countdownInterval);

      generateFloatingParticles();
      displayMemories(); // Call to display memories in the new section
    }

    function staggerHeartsAppearance() {
      const heartEmojis = ['❤️', '💕', '💓', '💗', '💖', '💘', '💝', '💞', '💟', '❤️‍🔥', '✨', '🩷', '💜']; // More heart emojis
      heartsContainer.innerHTML = '';
      heartsContainer.style.display = 'flex';

      heartEmojis.forEach((emoji, index) => {
        const span = document.createElement('span');
        span.classList.add('heart');
        span.textContent = emoji;
        span.style.animationDelay = `${index * 0.1}s`;
        heartsContainer.appendChild(span);
        setTimeout(() => span.style.opacity = 1, 50 + index * 100);
      });
    }

    // --- Interactive Love Dots Logic ---
    const memories = [
      "Hal-hal kecil tentang kamu itu selalu nyangkut di kepala... dan aku suka itu.",
      "Stroberi yang ngingetin aku sama kamu — ceria, manis, dan bikin senyum tanpa sadar.",
      "Momen pertama kali kita ketemu. Rasanya hangattt.",
      "Matcha juga kayak kamu... tenangin hati, adem, dan selalu bikin rileks.",
      "Kangen banget ngobrol sama kamu sampai larut, bahas hal random yang cuma kita ngerti.",
      "Senengnya bisa jalanin hari bareng kamu, walaupun kadang cuma lewat chat atau telfon.",
      "Aku suka gimana kamu selalu support semua impian aku, sekecil apapun itu."
    ];

    // Function to display memories in the new section
    function displayMemories() {
        memories.forEach(memory => {
            const listItem = document.createElement('li');
            listItem.textContent = `• ${memory}`;
            memoriesList.appendChild(listItem);
        });
    }

    document.getElementById('personal-memory').textContent = memories[Math.floor(Math.random() * memories.length)];

    document.querySelectorAll('.love-dot').forEach(dot => {
      dot.addEventListener('click', function() {
        const reasonDisplay = document.getElementById('love-reason-display');
        document.querySelectorAll('.love-dot').forEach(d => d.classList.remove('active'));
        this.classList.add('active');
        reasonDisplay.textContent = `💖 Karena ${this.dataset.reason} 💖`;
      });
    });

    // --- Media Interaction Handlers ---
    // Event listeners for ALL local videos to pause background music and other local videos when played
    // EXCEPTION for ourPlantVideo: it will NOT pause background music on play.
    openingVideo.addEventListener('play', () => stopAllOtherMedia(openingVideo));
    openingVideo.addEventListener('pause', () => { if (audioPlayer.src) playBackgroundMusic(); });
    openingVideo.addEventListener('ended', () => { if (audioPlayer.src) playBackgroundMusic(); });

    // ourPlantVideo will NOT call stopAllOtherMedia, so BGM will keep playing
    // However, if other videos are playing, ourPlantVideo should still pause them.
    ourPlantVideo.addEventListener('play', () => {
        [openingVideo, finalVideo].forEach(video => { // Only pause other specific videos
            if (video) video.pause();
        });
    });
    // ourPlantVideo's pause/ended doesn't need to explicitly resume BGM, as BGM never stopped for it.
    // If BGM was stopped by another element *before* ourPlantVideo played, it will stay stopped.

    // finalVideo is handled in showFinal() to permanently stop BGM

    // For TikTok iframes, we can't directly control playback, but we can react to user interaction.
    // When a user interacts (mouse enters/touch), we assume they might play the TikTok, so we stop our background music.
    tiktokFrames.forEach(frame => {
      frame.addEventListener('mouseenter', () => stopAllOtherMedia(null)); // Pass null, as TikTok is not a local video
      frame.addEventListener('touchstart', () => stopAllOtherMedia(null)); // Pass null
      // Removed mouseleave/touchend to prevent BGM from restarting too frequently if user
      // is just hovering over different iframes. The main video/audio will handle resume.
    });

    // For Spotify iframe, similar to TikTok, react to user interaction.
    window.addEventListener("message", (e) => {
      // Adjusted origin check based on typical Spotify embed origins
      if (e.origin.includes("spotify.com")) {
        // Assume any interaction from Spotify iframe means play, so stop other media
        stopAllOtherMedia(null); // Pass null, as Spotify is not a local video
      }
    });

    // Prevent default touch behavior for better mobile experience with scrolling
    document.addEventListener('touchmove', function(event) {
      // Allow scrolling, but prevent other default touch actions if needed
    }, { passive: false });

    // Initial setup
    heartsContainer.style.display = 'none'; // Hide hearts until video ends
  </script>
</body>
</html>
